<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Putting It All Together &mdash; Quark 0.3.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/better.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.3.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Quark 0.3.1 documentation" href="../../index.html" />
    <link rel="up" title="Getting Started with RPC Walkthrough" href="index.html" />
    <link rel="next" title="More Information" href="links.html" />
    <link rel="prev" title="Running the Javascript Client and Server" href="javascriptRun.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  </head>
  <body role="document">
    <header id="pageheader"><h1><a href="../../index.html ">
        Quark 0.3.1 documentation
    </a></h1></header>
  <div class="related top">
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="javascriptRun.html" title="Previous document">Running the Javascript Client and Server</a>
        </li>
        <li>
          <a href="links.html" title="Next document">More Information</a>
          &rarr;
        </li>
    </ul>
  </nav>
  <nav id="breadcrumbs">
    <ul>
      <li><a href="../../index.html">Quark 0.3.1 documentation</a></li>
      <li>
        <a href="index.html">Getting Started with RPC Walkthrough</a>
      </li> 
    </ul>
  </nav>
  </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="putting-it-all-together">
<h1>Putting It All Together<a class="headerlink" href="#putting-it-all-together" title="Permalink to this headline">¶</a></h1>
<p>We now have all of the pieces needed for a simple working RPC example. The instructions on this page assume you have already followed the directives for building and installing the HelloRPC service contract in Python, Java, and Javascript as outlined earlier in the tutorial (separately for each language). If you have not done this, please do so now before trying the steps below.</p>
<ul class="simple">
<li><a class="reference internal" href="pythonBuild.html"><em>Building and installing in Python</em></a></li>
<li><a class="reference internal" href="javaBuild.html"><em>Building and installing in Java</em></a></li>
<li><a class="reference internal" href="javascriptBuild.html"><em>Building and installing in Javascript</em></a></li>
</ul>
<p>Let&#8217;s start by using the Python client we wrote to talk to the Python server we wrote.</p>
<div class="section" id="part-1-python-client-and-python-server">
<h2>Part 1: Python Client and Python Server<a class="headerlink" href="#part-1-python-client-and-python-server" title="Permalink to this headline">¶</a></h2>
<p>To run the HelloRPC example with a Python client and Python Server do the following:</p>
<p>Step 1: Move to the location where you saved the Python server you wrote earlier in the tutorial. Alternately, move to the HelloRPC directory within your local Quark git repository. If you use the default location, do the following: <code class="docutils literal"><span class="pre">cd</span> <span class="pre">~/quark/examples/helloRPC</span></code></p>
<p>Step 2: Run the server by executing the following command: <code class="docutils literal"><span class="pre">python</span> <span class="pre">pyserver.py</span></code>. This will result in a blocking wait state - there is no direct output to stdout from the Python server.</p>
<p>Step 3: Open a second terminal window</p>
<p>Step 4: Move to the location where you saved the Python client you wrote earlier in the tutorial. Alternately, move to the HelloRPC directory within your local Quark git repository. If you use the default location, do the following: <code class="docutils literal"><span class="pre">cd</span> <span class="pre">~/quark/examples/helloRPC</span></code></p>
<p>Step 4: Run the client by executing the following command: <code class="docutils literal"><span class="pre">python</span> <span class="pre">pyclient.py</span></code></p>
<p>You should see the following in your terminal window (stdout):</p>
<div class="highlight-none"><div class="highlight"><pre>Request says &#39;Hello from Python!&#39;
Response says u&#39;Responding to [Hello from Python!] from Python&#39;
</pre></div>
</div>
<p>[[JMK why is the u only present on the second line? I need to understand this better]]</p>
<p>The u in the response text indicates that the response is in Unicode. The first line is defined and printed by these two lines in the Python client we wrote:</p>
<div class="highlight-none"><div class="highlight"><pre>request.text = &quot;Hello from Python!&quot;
print &quot;Request says %r&quot; % request.text
</pre></div>
</div>
<p>The second line is printed by this line in the Python client we wrote:</p>
<div class="highlight-none"><div class="highlight"><pre>print &quot;Response says %r&quot; % response.result
</pre></div>
</div>
<p>The value of response.result is set in the server inside the implementation definition (HelloImpl class) using this line:</p>
<div class="highlight-none"><div class="highlight"><pre>res.result = &quot;Responding to [%s] from Python&quot; % request.text
</pre></div>
</div>
<p>[[JMK note that the %r in the client print lines should likely be %s and the %s in the server code should likely be %s. See issue #85]]</p>
</div>
<div class="section" id="part-2-running-two-servers">
<h2>Part 2: Running Two Servers<a class="headerlink" href="#part-2-running-two-servers" title="Permalink to this headline">¶</a></h2>
<p>The Hello RPC service is hard coded to run at <a class="reference external" href="http://127.0.0.1:8910/hello">http://127.0.0.1:8910/hello</a>. All of the servers and clients assume the service is there. Because all three servers use the same URI, only one server can be running at any given time. Try to launch a second server in Javascript while the Python server is still running as follows:</p>
<p>Step 1: Open a new terminal window</p>
<p>Step 2: Move to the HelloRPC directory within your local Quark git repository if you are not already there. If you use the default location, do the following: <code class="docutils literal"><span class="pre">cd</span> <span class="pre">~/quark/examples/helloRPC</span></code>.</p>
<p>Step 3: Run the Javascript server by executing the following command: <code class="docutils literal"><span class="pre">node</span> <span class="pre">jsserver.js</span></code>.</p>
<p>You should get the following error indicating that the service URI is already in use and the server cannot be started:</p>
<div class="highlight-none"><div class="highlight"><pre>RPC Server failed to register http://127.0.0.1:8910/hello due to:
listen EADDRINUSE 127.0.0.1:8910
</pre></div>
</div>
<p>Note: There is no line break in the real error</p>
<p>You will get a similar error if you try to start a second Python server or a Java server.</p>
</div>
<div class="section" id="part-3-mixing-client-and-server-languages">
<h2>Part 3: Mixing Client and Server Languages<a class="headerlink" href="#part-3-mixing-client-and-server-languages" title="Permalink to this headline">¶</a></h2>
<p>You can run either client (Java or Python) against any of the three servers (Java, Javascript, or Python). The only rule is that only one server can be running at a time (as illustrated in Part 2).</p>
<p>You should already have the Python server running. Let&#8217;s use the Java client to connect to that server as follows:</p>
<p>Step 1: Open a new terminal window</p>
<p>Step 2: Move to the HelloRPC directory within your local Quark git repository if you are not already there. If you use the default location, do the following: <code class="docutils literal"><span class="pre">cd</span> <span class="pre">~/quark/examples/helloRPC</span></code>.</p>
<p>Step 3: Run the following command to build the client: <code class="docutils literal"><span class="pre">mvn</span> <span class="pre">compile</span></code></p>
<p>Step 4: Run the following command to start the Java client: <code class="docutils literal"><span class="pre">mvn</span> <span class="pre">exec:java</span> <span class="pre">-Dexec.mainClass=helloRPC.HelloRPCClient</span></code></p>
<p>After some log lines outlining the processing, you should see the following in the terminal window (stdout):</p>
<div class="highlight-none"><div class="highlight"><pre>Request says: Hello from Java!
Response says: Responding to [Hello from Java!] from Python
</pre></div>
</div>
<p>Remember, the content of the second line is the server regurgitating what the client sent it then identifying its language. In this case, the Java client sent &#8220;Hello from Java!&#8221; to the Python server.</p>
<p>You can get similar results from any of the six language combinations. Using the Python client to talk to the Javascript server would yield the following text:</p>
<div class="highlight-none"><div class="highlight"><pre>Request says &#39;Hello from Python!&#39;
Response says u&#39;Responding to [Hello from Python!] from JS&#39;
</pre></div>
</div>
<p>Note that there are subtle differences in the output from different combinations above - the Python client places a single quote around request.text and response.result when printing them while the Java client doesn&#8217;t use the quotation marks. Conversely, the Java client uses a colon before the stored text while the Python client does not. Also, Java doesn&#8217;t indicate that the response is in Unicode by prepending a u to the output from the server. The client does all of the actual printing, so the format only depends on which client is being used and not which server is running at the time.</p>
<p>[[JMK I&#8217;m not sure if I should keep or kill the above observation - it&#8217;s interesting but possibly overkill. Also, we should probably clean up the inconsistency and use the same text/formatting from all of the clients.]]</p>
<p>That&#8217;s it! You should now understand how to define clients and servers to use the basic RPC interaction pattern defined in Quark and have seen those clients and servers in action in multiple languages. Time to experiment some more on your own!</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Putting It All Together</a><ul>
<li><a class="reference internal" href="#part-1-python-client-and-python-server">Part 1: Python Client and Python Server</a></li>
<li><a class="reference internal" href="#part-2-running-two-servers">Part 2: Running Two Servers</a></li>
<li><a class="reference internal" href="#part-3-mixing-client-and-server-languages">Part 3: Mixing Client and Server Languages</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="javascriptRun.html"
                        title="previous chapter">Running the Javascript Client and Server</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="links.html"
                        title="next chapter">More Information</a></p>
<div class="sourcelink">
  <a href="../../_sources/tutorials/rpc-basic/try.txt" rel="nofollow">
    Show page source
  </a>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="related bottom">
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="javascriptRun.html" title="Previous document">Running the Javascript Client and Server</a>
        </li>
        <li>
          <a href="links.html" title="Next document">More Information</a>
          &rarr;
        </li>
    </ul>
  </nav>
  <nav id="breadcrumbs">
    <ul>
      <li><a href="../../index.html">Quark 0.3.1 documentation</a></li>
      <li>
        <a href="index.html">Getting Started with RPC Walkthrough</a>
      </li> 
    </ul>
  </nav>
  </div>

  <footer id="pagefooter">&copy; 2015, Datawire.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a>
      1.3.3.

  </footer>

  

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57322503-4', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>