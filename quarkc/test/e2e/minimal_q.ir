    Package(
        Function(
            Name("minimal:mdk.init"), Type(Ref("minimal:mdk.api.MDK")),
            Block(Return(Invoke(Ref("minimal:mdk.api.GetMDK"))))
        ),
        Function(
            Name("minimal:mdk.start"), Type(Ref("minimal:mdk.api.MDK")),
            Block(
                Local("m", Type(Ref("minimal:mdk.api.MDK")), Invoke(Ref("minimal:mdk.init"))),
                Evaluate(Send(Var("m"), "start", ())),
                Return(Var("m"))
            )
        ),
        Interface(
            Name("minimal:mdk.api.Session"),
            Message("externalize", String()),
            Message("log", Void(), Param("msg", String()))
        ),
        Interface(
            Name("minimal:mdk.api.Plugin"),
            Message("init", Void(), Param("mdk", InterfaceType(Ref("minimal:mdk.api.MDK")))),
            Message("onSession", Void(), Param("s", "minimal:mdk.api.Session"))
        ),
        Interface(
            Name("minimal:mdk.api.MDK"),
            Message("start", Void()),
            Message("session", InterfaceType(Ref("minimal:mdk.api.Session"))),
            Message("join", InterfaceType(Ref("minimal:mdk.api.Session")), Param("id", String())),
            Message("stop", Void()),
            Message("register", Void(), Param("plugin", InterfaceType(Ref("minimal:mdk.api.Plugin"))))
        ),
        Function(Name("minimal:mdk.api.GetMDK"), InterfaceType(Ref("minimal:mdk.api.MDK")),
                 Block(Return(Construct(Ref("minimal:mdk.impl.MDK"), ())))
        ),
        Class(Name("minimal:mdk.impl.MDK"),
              InterfaceType(Ref("minimal:mdk.api.MDK")),
              Field("plugin", InterfaceType(Ref("minimal:mdk.api.Plugin"))),
              Constructor("MDK", ClassType(Ref("minimal:mdk.impl.MDK")), Block()
              ),
              Method("start", Void(), Block()
              ),
              Method("session", InterfaceType(Ref("minimal:mdk.api.Session")), Block(
                  Return(
                      Send(This(), "_session", (
                          Invoke(Ref("minimal:mdk.helpers.uuid")), ))
                  ))
              ),
              Method("join", InterfaceType(Ref("minimal:mdk.api.Session")),
                      Param("id", String()),
                      Block(Return(Send(This(), "_session", (Var("id"), ))))
              ),
              Method("_session", InterfaceType(Ref("minimal:mdk.api.Session")),
                     Param("id", String()),
                     Block(
                         Local("s", InterfaceType(Ref("minimal:mdk.api.Session")),
                               Construct(Ref("minimal:mdk.impl.Session"),
                                         (This(), Var("id")))),
                         If(Invoke(Ref("minimal:minimal.quark.object___ne__"), Get(This(), "plugin"), Null(InterfaceType(Ref("minimal:mdk.api.Plugin")))),
                            Block(
                                Send(Get(This(), "plugin"), "onSession", (Var("s"), ))
                            ),
                            Block()
                         ),
                         Return(Var("s")))
              ),
              Method("stop", Void(), Block()),
              Method("register", Void(),
                     Param("plugin", InterfaceType(Ref("minimal:mdk.api.Plugin"))),
                     Block(
                         Set(This(), "plugin", Var("plugin")),
                         Evaluate(Send(Var("plugin"), "init", (This(), )))
                     )
              )
        ),
        Class(Name("minimal:mdk.impl.Session"),
              InterfaceType(Ref("minimal:mdk.api.Session")),
              Field("mdk", ClassType(Ref("minimal:mdk.impl.MDK"))),
              Field("id", String()),
              Constructor("Session", ClassType(Ref("minimal:mdk.impl.Session")),
                          Param("mdk", ClassType(Ref("minimal:mdk.impl.MDK"))),
                          Param("id", String()),
                          Block(
                              # user code
                              Set(This(), "mdk", Var("mdk")),
                              Set(This(), "id", Var("id")),
                          )),
              Method("log", Void(), Param("msg", String()),
                     Block(Invoke(Ref("minimal:minimal.quark.print"), Var("msg")))),
              Method("externalize", String(),
                     Block(Return(StringLit("id"))))
              ),
        Function(Name("minimal:mdk.helpers.uuid"), String(),
                 Block(Return(StringLit("u-u-i-d")))),
        NativeFunction(Name("minimal:minimal.quark.object___ne__"),
                       Bool(), Param("a", Any()), Param("b", Any()),
                       TemplateContext(("a", Var("a")),
                                     ("b", Var("b"))),
                       TemplateText("java",       (), "return {a} != {b};"),
                       TemplateText("python",     (),
                                    """
                                    if {a} != {b}:
                                        return True
                                    return False
                                    """),
                       TemplateText("go",         (), "return {a} != {b}"),
                       TemplateText("ruby",       (), "return {a} != {b}"),
                       TemplateText("javascript", (), "return {a} != {b}")),
        NativeFunction(Name("minimal:minimal.quark.print"),
                       Void(), Param("a", Any()),
                       TemplateContext(("a", Var("a"))),
                       TemplateText("java",       (), "System.out.println(a);"),
                       TemplateText("python",     (), "print(a)"),
                       TemplateText("go",         (NativeImport("fmt", "fmt"),), "fmt.Println(a)"),
                       TemplateText("ruby",       (), "puts a"),
                       TemplateText("javascript", (), "console.log(a)")),
    )
